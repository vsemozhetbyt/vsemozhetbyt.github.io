<!doctype html>
<html>
	<head><meta charset="UTF-8"><title>Bookmarklets</title></head>
	<body style="text-align: center; font-family: monospace; font-size: 12pt;">
		<p><a href="javascript:(function(d, l, news, curs, prevs, div, closer, pre, lb, op, ln) {if (d.querySelector('div[data-imdb-charts-diff]')) {return;}curs.urls = [].map.call(d.querySelectorAll('table.chart > tbody > tr > td.titleColumn a[href]'), function(el) {return el.pathname;});curs.titles = [].map.call(d.querySelectorAll('table.chart > tbody > tr > td.titleColumn a[href]'), function(el) {return el.parentNode.textContent.trim().replace(/\s+/g, ' ');});prevs = JSON.parse(localStorage['IMDbChartsDiff: ' + l.pathname] || '{\x22urls\x22:[],\x22titles\x22:[]}');div = d.createElement('div');div.setAttribute('data-imdb-charts-diff', '');div.appendChild(d.createElement('style')).textContent=['div[data-imdb-charts-diff] {position:fixed; top:0px; left:0; z-index:999999; padding: 0px 10px 0px 5px !important; background-color: gainsboro !important; outline: 1px solid black !important; text-align: left !important;}','div[data-imdb-charts-diff] pre * {font-size: 12pt !important; font-family: monospace !important; font-weight: normal !important;}',].join('\n');closer = div.appendChild(d.createElement('button'));closer.type = 'button';closer.textContent = 'x';closer.addEventListener('click', function(){d.querySelector('table.chart').style.display = 'table';[].forEach.call(d.querySelectorAll('table.chart > tbody > tr'), function(el) {el.style.display = 'table-row';});div.parentNode.removeChild(div);});d.body.appendChild(div);if (curs.urls.length) {if (!prevs.urls.length) {div.appendChild(d.createElement('pre')).textContent = 'First launch.\n\nData saved (' + curs.urls.length + ' entries).';}else {news['+'] = curs.urls.filter(function(el) {return prevs.urls.indexOf(el) == -1;});news['\u2191'] = prevs.urls.filter(function(el, pi, ar, ci) {ci = curs.urls.indexOf(el); return ci > -1 && ci < pi;});news['\u2193'] = prevs.urls.filter(function(el, pi) {return curs.urls.indexOf(el) > pi;});news['-'] = prevs.urls.filter(function(el) {return curs.urls.indexOf(el) == -1;});news['='] = prevs.urls.filter(function(el, pi) {return curs.urls.indexOf(el) === pi;});if(news['+'].length || news['\u2191'].length || news['\u2193'].length || news['-'].length) {for (var k in news) {ln = news[k].length;pre = div.appendChild(d.createElement('pre'));lb = pre.appendChild(d.createElement('label'));op = lb.appendChild(d.createElement('input'));op.type = 'radio';op.name = 'news';op.value = k;op.checked = false;op.disabled = !ln;op.addEventListener('click', toggleElms);lb.appendChild(document.createTextNode(ln + '\t' + k));}if (news['-'].length) {pre = div.querySelector('input[value=\'-\']').parentNode.parentNode.appendChild(d.createElement('pre'));pre.innerHTML = news['-'].map(function(el) {return '<a href=\'' + el + '\' target=\'_blank\'>' + prevs.titles[prevs.urls.indexOf(el)] + '</a>';}).join('\n');}news['\u2191'].forEach(function(el) {d.querySelector('table.chart > tbody > tr > td.titleColumn a[href^=\'' + el + '\']').parentNode.title = '\u2191 ' + (prevs.urls.indexOf(el) + 1) + ' \u2192 ' + (curs.urls.indexOf(el) + 1);});news['\u2193'].forEach(function(el) {d.querySelector('table.chart > tbody > tr > td.titleColumn a[href^=\'' + el + '\']').parentNode.title = '\u2193 ' + (prevs.urls.indexOf(el) + 1) + ' \u2192 ' + (curs.urls.indexOf(el) + 1);});div.querySelector('input:enabled').click();}else {div.appendChild(d.createElement('pre')).textContent = 'No news.';}}localStorage['IMDbChartsDiff: ' + l.pathname] = JSON.stringify(curs);}else {div.appendChild(d.createElement('pre')).textContent = 'Parsing error.';}function toggleElms(evt, grp) {if (evt.target.value === '-') {d.querySelector('table.chart').style.display = 'none';div.querySelector('pre > pre').style.display = 'block';}else {if (div.querySelector('pre > pre')) {d.querySelector('table.chart').style.display = 'table';div.querySelector('pre > pre').style.display = 'none';}grp = news[evt.target.value];[].forEach.call(d.querySelectorAll('table.chart > tbody > tr'), function(el) {if (grp.indexOf(el.querySelector('td.titleColumn a[href]').pathname) !== -1) {el.style.display = 'table-row';}else {el.style.display = 'none';}});}}})(document, location, {}, {});">IMDb Charts Diff</a></p>
	</body>
</html>
